---
title: "Click CLI Framework"
date: 2024-12-12T21:10:00Z
draft: false
description: "Building CLI applications with Click in Python"
type: "snippet"
tags: ["python", "click", "cli", "command-line", "python-knowhow"]
category: "python"
---



Click is a Python package for creating beautiful command-line interfaces with minimal code. Uses decorators for a clean, composable API. Powers Flask, AWS CLI, and many other tools.

## Use Case

Use Click when you need to:
- Build CLI tools in Python
- Create nested command groups
- Handle complex option parsing
- Generate automatic help pages

## Installation

```bash
pip install click
```

## Code

### Basic Command

```python
import click

@click.command()
@click.option('--name', default='World', help='Name to greet')
@click.option('--count', default=1, help='Number of greetings')
def hello(name, count):
    """Simple program that greets NAME COUNT times."""
    for _ in range(count):
        click.echo(f'Hello, {name}!')

if __name__ == '__main__':
    hello()
```

## Examples

### Example 1: Options and Arguments

```python
import click

@click.command()
@click.option('--verbose', '-v', is_flag=True, help='Verbose output')
@click.option('--output', '-o', type=click.Path(), help='Output file')
@click.option('--format', type=click.Choice(['json', 'yaml', 'text']), 
              default='text', help='Output format')
@click.argument('input_file', type=click.Path(exists=True))
def process(verbose, output, format, input_file):
    """Process INPUT_FILE and optionally save to OUTPUT."""
    if verbose:
        click.echo(f'Processing {input_file}...')
    
    # Process file
    result = f"Processed {input_file} as {format}"
    
    if output:
        with open(output, 'w') as f:
            f.write(result)
        click.echo(f'Saved to {output}')
    else:
        click.echo(result)

if __name__ == '__main__':
    process()
```

**Usage:**
```bash
$ python app.py input.txt
Processed input.txt as text

$ python app.py input.txt -v -o output.txt --format json
Processing input.txt...
Saved to output.txt
```

### Example 2: Command Groups (Subcommands)

```python
import click

@click.group()
def cli():
    """My CLI application with subcommands."""
    pass

@cli.command()
def init():
    """Initialize the application."""
    click.echo('Initializing...')

@cli.command()
@click.option('--port', default=8000, help='Port number')
def serve(port):
    """Start the server."""
    click.echo(f'Starting server on port {port}...')

@cli.group()
def config():
    """Manage configuration."""
    pass

@config.command('get')
@click.argument('key')
def config_get(key):
    """Get configuration value."""
    click.echo(f'Getting config: {key}')

@config.command('set')
@click.argument('key')
@click.argument('value')
def config_set(key, value):
    """Set configuration value."""
    click.echo(f'Setting {key} = {value}')

if __name__ == '__main__':
    cli()
```

**Usage:**
```bash
$ python app.py init
Initializing...

$ python app.py serve --port 3000
Starting server on port 3000...

$ python app.py config get database.host
Getting config: database.host

$ python app.py config set database.host localhost
Setting database.host = localhost
```

### Example 3: Prompts and Confirmation

```python
import click

@click.command()
@click.option('--name', prompt='Your name', help='Name to greet')
@click.option('--password', prompt=True, hide_input=True, 
              confirmation_prompt=True, help='Password')
@click.confirmation_option(prompt='Are you sure you want to continue?')
def secure_hello(name, password):
    """Secure greeting with prompts."""
    click.echo(f'Hello, {name}!')
    click.echo('Password accepted')

if __name__ == '__main__':
    secure_hello()
```

**Usage:**
```bash
$ python app.py
Your name: John
Password: 
Repeat for confirmation: 
Are you sure you want to continue? [y/N]: y
Hello, John!
Password accepted
```

### Example 4: Progress Bars and Styling

```python
import click
import time

@click.command()
@click.option('--items', default=100, help='Number of items')
def process_items(items):
    """Process items with progress bar."""
    
    # Progress bar
    with click.progressbar(range(items), label='Processing') as bar:
        for item in bar:
            time.sleep(0.01)  # Simulate work
    
    # Styled output
    click.secho('Success!', fg='green', bold=True)
    click.secho('Warning: Some items skipped', fg='yellow')
    click.secho('Error details', fg='red', err=True)
    
    # Formatted output
    click.echo(click.style('Processed: ', fg='blue') + 
               click.style(str(items), fg='cyan', bold=True))

if __name__ == '__main__':
    process_items()
```

### Example 5: Context and Shared State

```python
import click

@click.group()
@click.option('--debug/--no-debug', default=False)
@click.pass_context
def cli(ctx, debug):
    """CLI with shared context."""
    ctx.ensure_object(dict)
    ctx.obj['DEBUG'] = debug

@cli.command()
@click.pass_context
def status(ctx):
    """Show status."""
    if ctx.obj['DEBUG']:
        click.echo('Debug mode is ON')
    click.echo('Status: OK')

@cli.command()
@click.option('--config', type=click.File('r'))
@click.pass_context
def run(ctx, config):
    """Run with configuration."""
    if ctx.obj['DEBUG']:
        click.echo('Debug: Loading config...')
    
    if config:
        content = config.read()
        click.echo(f'Config loaded: {len(content)} bytes')

if __name__ == '__main__':
    cli(obj={})
```

### Example 6: Custom Types and Validation

```python
import click

class EmailType(click.ParamType):
    name = "email"
    
    def convert(self, value, param, ctx):
        if '@' not in value:
            self.fail(f'{value} is not a valid email', param, ctx)
        return value

EMAIL = EmailType()

@click.command()
@click.option('--email', type=EMAIL, required=True)
@click.option('--age', type=click.IntRange(0, 120), required=True)
@click.option('--score', type=click.FloatRange(0.0, 100.0))
def register(email, age, score):
    """Register user with validation."""
    click.echo(f'Email: {email}')
    click.echo(f'Age: {age}')
    if score:
        click.echo(f'Score: {score}')

if __name__ == '__main__':
    register()
```

### Example 7: File Handling

```python
import click

@click.command()
@click.argument('input', type=click.File('r'))
@click.argument('output', type=click.File('w'))
@click.option('--uppercase', is_flag=True)
def convert(input, output, uppercase):
    """Convert INPUT file to OUTPUT file."""
    content = input.read()
    
    if uppercase:
        content = content.upper()
    
    output.write(content)
    click.echo(f'Converted {input.name} -> {output.name}')

if __name__ == '__main__':
    convert()
```

**Usage:**
```bash
$ python app.py input.txt output.txt --uppercase
Converted input.txt -> output.txt

# Can use stdin/stdout
$ echo "hello" | python app.py - -
HELLO
```

## Common Patterns

### Environment Variables

```python
@click.command()
@click.option('--api-key', envvar='API_KEY', required=True)
def api_call(api_key):
    """Call API with key from env or flag."""
    click.echo(f'Using API key: {api_key[:4]}...')
```

### Multiple Values

```python
@click.command()
@click.option('--tag', multiple=True)
def tag_items(tag):
    """Add multiple tags."""
    for t in tag:
        click.echo(f'Tag: {t}')

# Usage: python app.py --tag python --tag cli --tag tool
```

### Callbacks

```python
def validate_port(ctx, param, value):
    if value < 1024:
        raise click.BadParameter('Port must be >= 1024')
    return value

@click.command()
@click.option('--port', callback=validate_port, type=int)
def serve(port):
    click.echo(f'Port: {port}')
```

## Notes

- Arguments are required by default, options are optional
- Use `@click.pass_context` to share state between commands
- `click.echo()` is better than `print()` (handles encoding)
- Progress bars work automatically with iterables
- Click handles `--help` automatically

## Gotchas/Warnings

- ⚠️ **Arguments vs Options**: Arguments are positional, options have flags
- ⚠️ **Order matters**: Decorators are applied bottom-to-top
- ⚠️ **File objects**: Click handles opening/closing automatically
- ⚠️ **Context**: Use `@click.pass_context` to access shared state