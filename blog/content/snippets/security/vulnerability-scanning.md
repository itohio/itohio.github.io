---
title: "Vulnerability Scanning Tools"
date: 2024-12-13
draft: false
category: "security"
tags: ["security", "vulnerability", "scanning", "penetration-testing", "nmap", "burp"]
---

Tools and techniques for scanning web services and applications for security vulnerabilities.

## Overview

**Vulnerability scanning** identifies security weaknesses in applications, networks, and systems before attackers can exploit them.

**Scanning Types:**
- Network scanning
- Web application scanning
- API security testing
- Container/cloud scanning
- Dependency scanning

---

## Network Scanning

### Nmap (Network Mapper)

Essential network discovery and security auditing tool.

```bash
# Install
sudo apt-get install nmap  # Debian/Ubuntu
brew install nmap          # macOS

# Basic host discovery
nmap 192.168.1.0/24

# Port scanning
nmap -p 80,443 target.com
nmap -p 1-65535 target.com  # All ports
nmap -p- target.com         # All ports (shorthand)

# Service version detection
nmap -sV target.com

# OS detection
sudo nmap -O target.com

# Aggressive scan (OS, version, scripts, traceroute)
sudo nmap -A target.com

# Vulnerability scanning with NSE scripts
nmap --script vuln target.com
nmap --script=http-vuln-* target.com

# Specific vulnerabilities
nmap --script ssl-heartbleed target.com
nmap --script http-sql-injection target.com

# Stealth scan
sudo nmap -sS target.com

# UDP scan
sudo nmap -sU target.com

# Save results
nmap -oN output.txt target.com      # Normal format
nmap -oX output.xml target.com      # XML format
nmap -oG output.gnmap target.com    # Greppable format
nmap -oA output target.com          # All formats
```

### Common Nmap NSE Scripts

```bash
# Web vulnerabilities
nmap --script http-csrf target.com
nmap --script http-stored-xss target.com
nmap --script http-dombased-xss target.com

# SSL/TLS testing
nmap --script ssl-cert,ssl-enum-ciphers target.com
nmap --script ssl-poodle target.com

# Authentication
nmap --script auth target.com
nmap --script http-brute --script-args userdb=users.txt,passdb=passes.txt target.com

# Database scanning
nmap -p 3306 --script mysql-* target.com
nmap -p 5432 --script pgsql-* target.com
nmap -p 1433 --script ms-sql-* target.com

# SMB vulnerabilities
nmap --script smb-vuln-* target.com
```

---

## Web Application Scanning

### OWASP ZAP (Zed Attack Proxy)

Free, open-source web application security scanner.

#### Installation

```bash
# Download from https://www.zaproxy.org/download/

# Or via package manager
sudo apt-get install zaproxy  # Debian/Ubuntu
brew install --cask owasp-zap # macOS

# Docker
docker run -u zap -p 8080:8080 owasp/zap2docker-stable zap-webswing.sh
```

#### CLI Usage

```bash
# Quick scan
zap-cli quick-scan http://target.com

# Full scan
zap-cli active-scan http://target.com

# Spider website first
zap-cli spider http://target.com
zap-cli active-scan http://target.com

# Generate report
zap-cli report -o report.html -f html

# Authenticated scanning
zap-cli --api-key YOUR_KEY \
        --zap-url http://localhost:8080 \
        open-url http://target.com/login
```

#### Python API

```python
from zapv2 import ZAPv2

# Connect to ZAP
zap = ZAPv2(apikey='your-api-key', proxies={
    'http': 'http://127.0.0.1:8080',
    'https': 'http://127.0.0.1:8080'
})

# Spider target
print('Spidering target...')
scan_id = zap.spider.scan('http://target.com')
while int(zap.spider.status(scan_id)) < 100:
    print(f'Spider progress: {zap.spider.status(scan_id)}%')
    time.sleep(2)

# Active scan
print('Active scanning...')
scan_id = zap.ascan.scan('http://target.com')
while int(zap.ascan.status(scan_id)) < 100:
    print(f'Scan progress: {zap.ascan.status(scan_id)}%')
    time.sleep(5)

# Get alerts
alerts = zap.core.alerts(baseurl='http://target.com')
for alert in alerts:
    print(f"[{alert['risk']}] {alert['alert']}")
    print(f"  URL: {alert['url']}")
    print(f"  Description: {alert['description']}")
```

### Nikto

Web server scanner.

```bash
# Install
sudo apt-get install nikto

# Basic scan
nikto -h http://target.com

# Scan specific port
nikto -h target.com -p 8080

# SSL scan
nikto -h https://target.com -ssl

# Tune scan (select tests)
nikto -h target.com -Tuning 123456789ab

# Tuning options:
# 1: Interesting files
# 2: Misconfiguration
# 3: Information disclosure
# 4: Injection (XSS/Script/HTML)
# 5: Remote file retrieval
# 6: Denial of service
# 7: Remote file retrieval (inside web root)
# 8: Command execution
# 9: SQL injection
# a: Authentication bypass
# b: Software identification

# Save output
nikto -h target.com -o report.html -Format html

# Use proxy
nikto -h target.com -useproxy http://proxy:8080
```

### Nuclei

Fast vulnerability scanner using YAML templates.

```bash
# Install
go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest

# Update templates
nuclei -update-templates

# Scan single target
nuclei -u http://target.com

# Scan multiple targets
nuclei -l targets.txt

# Scan with specific templates
nuclei -u http://target.com -t cves/
nuclei -u http://target.com -t exposures/

# Scan for specific CVE
nuclei -u http://target.com -t cves/2021/CVE-2021-44228.yaml

# Custom severity
nuclei -u http://target.com -severity critical,high

# Rate limiting
nuclei -u http://target.com -rate-limit 10

# Output
nuclei -u http://target.com -o results.txt
nuclei -u http://target.com -json -o results.json
```

#### Custom Nuclei Template

```yaml
# custom-check.yaml
id: custom-admin-panel

info:
  name: Admin Panel Detection
  author: your-name
  severity: info
  description: Detects common admin panel paths

requests:
  - method: GET
    path:
      - "{{BaseURL}}/admin"
      - "{{BaseURL}}/administrator"
      - "{{BaseURL}}/wp-admin"
      - "{{BaseURL}}/admin.php"
    
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 301
          - 302
      
      - type: word
        words:
          - "admin"
          - "login"
          - "dashboard"
        condition: or
```

```bash
# Run custom template
nuclei -u http://target.com -t custom-check.yaml
```

---

## API Security Testing

### Postman

```javascript
// Pre-request script: SQL injection test
pm.environment.set("payload", "' OR '1'='1");

// Test script: Check for vulnerabilities
pm.test("No SQL error in response", function () {
    pm.expect(pm.response.text()).to.not.include("SQL syntax");
    pm.expect(pm.response.text()).to.not.include("mysql_fetch");
});

pm.test("Response time acceptable", function () {
    pm.expect(pm.response.responseTime).to.be.below(5000);
});
```

### RESTler

Microsoft's REST API fuzzer.

```bash
# Install
pip install restler-fuzzer

# Compile API specification
restler compile --api_spec swagger.json

# Test
restler test --grammar_file Compile/grammar.py \
             --dictionary_file Compile/dict.json \
             --settings Compile/engine_settings.json

# Fuzz
restler fuzz --grammar_file Compile/grammar.py \
             --dictionary_file Compile/dict.json \
             --time_budget 1
```

### OWASP API Security Testing

```bash
# Using curl for manual testing

# 1. Broken Object Level Authorization
curl -H "Authorization: Bearer TOKEN" \
     http://api.target.com/users/123/orders
# Try changing user ID to access other users' data

# 2. Broken Authentication
curl -X POST http://api.target.com/auth/login \
     -d '{"username":"admin","password":"admin"}'
# Test weak credentials

# 3. Excessive Data Exposure
curl http://api.target.com/users/me
# Check if response includes sensitive fields

# 4. Lack of Rate Limiting
for i in {1..1000}; do
    curl http://api.target.com/api/endpoint &
done
# Check if rate limiting is enforced

# 5. Mass Assignment
curl -X POST http://api.target.com/users \
     -d '{"username":"test","is_admin":true}'
# Try to set privileged fields
```

---

## Specialized Scanners

### SQLMap (SQL Injection)

```bash
# Install
sudo apt-get install sqlmap

# Basic scan
sqlmap -u "http://target.com/page?id=1"

# POST request
sqlmap -u "http://target.com/login" \
       --data="username=admin&password=pass"

# With cookie
sqlmap -u "http://target.com/page?id=1" \
       --cookie="PHPSESSID=abc123"

# Enumerate databases
sqlmap -u "http://target.com/page?id=1" --dbs

# Enumerate tables
sqlmap -u "http://target.com/page?id=1" -D database_name --tables

# Dump table
sqlmap -u "http://target.com/page?id=1" \
       -D database_name -T users --dump

# Batch mode (non-interactive)
sqlmap -u "http://target.com/page?id=1" --batch

# Risk and level
sqlmap -u "http://target.com/page?id=1" --risk=3 --level=5

# Tamper scripts (bypass WAF)
sqlmap -u "http://target.com/page?id=1" \
       --tamper=space2comment,between
```

### XSStrike (XSS Scanner)

```bash
# Install
git clone https://github.com/s0md3v/XSStrike
cd XSStrike
pip install -r requirements.txt

# Scan URL
python xsstrike.py -u "http://target.com/search?q=test"

# Crawl and scan
python xsstrike.py -u "http://target.com" --crawl

# Scan with custom payload
python xsstrike.py -u "http://target.com/search?q=test" \
                   --payload "<script>alert(1)</script>"
```

### Commix (Command Injection)

```bash
# Install
git clone https://github.com/commixproject/commix
cd commix
python commix.py

# Scan URL parameter
python commix.py --url="http://target.com/page?cmd=test"

# POST data
python commix.py --url="http://target.com/page" \
                 --data="cmd=test&other=value"

# Cookie injection
python commix.py --url="http://target.com/page" \
                 --cookie="cmd=test"
```

---

## Container & Cloud Security

### Trivy (Container Vulnerability Scanner)

```bash
# Install
brew install aquasecurity/trivy/trivy  # macOS
sudo apt-get install trivy             # Debian/Ubuntu

# Scan Docker image
trivy image nginx:latest
trivy image myapp:1.0

# Scan filesystem
trivy fs /path/to/project

# Scan git repository
trivy repo https://github.com/user/repo

# Scan Kubernetes cluster
trivy k8s --report summary

# Output formats
trivy image --format json nginx:latest
trivy image --format sarif -o results.sarif nginx:latest

# Severity filtering
trivy image --severity HIGH,CRITICAL nginx:latest

# Ignore unfixed vulnerabilities
trivy image --ignore-unfixed nginx:latest
```

### Grype (Vulnerability Scanner)

```bash
# Install
brew install grype

# Scan image
grype nginx:latest

# Scan directory
grype dir:/path/to/project

# Output formats
grype nginx:latest -o json
grype nginx:latest -o table
grype nginx:latest -o cyclonedx
```

---

## Dependency Scanning

### OWASP Dependency-Check

```bash
# Install
brew install dependency-check

# Scan project
dependency-check --project "MyProject" \
                 --scan /path/to/project \
                 --out report.html

# Specific ecosystems
dependency-check --enableExperimental \
                 --scan /path/to/project \
                 --out report.html
```

### Snyk

```bash
# Install
npm install -g snyk

# Authenticate
snyk auth

# Test for vulnerabilities
snyk test

# Test Docker image
snyk container test nginx:latest

# Test Kubernetes
snyk iac test k8s-deployment.yaml

# Monitor project
snyk monitor

# Fix vulnerabilities
snyk fix
```

### Safety (Python)

```bash
# Install
pip install safety

# Check installed packages
safety check

# Check requirements file
safety check -r requirements.txt

# JSON output
safety check --json

# Ignore specific vulnerabilities
safety check --ignore 12345
```

---

## Automated Security Testing

### GitHub Actions Workflow

```yaml
# .github/workflows/security-scan.yml
name: Security Scan

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 0 * * 0'  # Weekly

jobs:
  dependency-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Run Snyk
        uses: snyk/actions/node@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
      
      - name: Run Trivy
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: 'fs'
          scan-ref: '.'
          format: 'sarif'
          output: 'trivy-results.sarif'
      
      - name: Upload results
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: 'trivy-results.sarif'
  
  web-scan:
    runs-on: ubuntu-latest
    steps:
      - name: ZAP Scan
        uses: zaproxy/action-baseline@v0.7.0
        with:
          target: 'https://target.com'
          rules_file_name: '.zap/rules.tsv'
          cmd_options: '-a'
```

---

## Web Application Firewall (WAF) Testing

### Bypass Techniques

```bash
# Test WAF presence
wafw00f http://target.com

# SQL injection bypass examples
# URL encoding
%27%20OR%20%271%27=%271

# Double encoding
%2527%2520OR%2520%25271%2527=%25271

# Case variation
' oR '1'='1

# Comment injection
'/**/OR/**/1=1--

# Null byte
%00' OR '1'='1

# Unicode
＇ OR ＇1＇=＇1
```

### Bypass Tools

```bash
# SQLMap with tamper scripts
sqlmap -u "http://target.com/?id=1" \
       --tamper=space2comment,between,randomcase

# Available tamper scripts:
# apostrophemask, apostrophenullencode, appendnullbyte
# base64encode, between, bluecoat, chardoubleencode
# charencode, charunicodeencode, concat2concatws
# equaltolike, greatest, halfversionedmorekeywords
# ifnull2ifisnull, modsecurityversioned, modsecurityzeroversioned
# multiplespaces, nonrecursivereplacement, percentage
# randomcase, randomcomments, securesphere, space2comment
# space2dash, space2hash, space2morehash, space2mssqlblank
# space2mssqlhash, space2mysqlblank, space2mysqldash
# space2plus, space2randomblank, sp_password, unionalltounion
# unmagicquotes, versionedkeywords, versionedmorekeywords
```

---

## Reporting & Prioritization

### Vulnerability Severity (CVSS)

```text
Critical (9.0-10.0):
- Remote code execution
- Authentication bypass
- SQL injection with data access

High (7.0-8.9):
- XSS with session hijacking
- CSRF on critical functions
- Privilege escalation

Medium (4.0-6.9):
- Information disclosure
- CSRF on non-critical functions
- Weak cryptography

Low (0.1-3.9):
- Minor information leaks
- Missing security headers
- Verbose error messages
```

### Sample Report Structure

```markdown
# Vulnerability Report

## Executive Summary
- Total vulnerabilities: 15
- Critical: 2
- High: 5
- Medium: 6
- Low: 2

## Critical Findings

### 1. SQL Injection in Login Form
**Severity:** Critical (CVSS 9.8)
**URL:** http://target.com/login
**Parameter:** username
**Payload:** `admin' OR '1'='1'--`

**Impact:**
- Full database access
- User credential theft
- Data modification

**Remediation:**
- Use parameterized queries
- Implement input validation
- Apply principle of least privilege

**Evidence:**
```sql
SELECT * FROM users WHERE username='admin' OR '1'='1'--' AND password='...'
```

### 2. Remote Code Execution
...
```

---

## Best Practices

```text
✅ DO:
- Get written permission before scanning
- Start with passive reconnaissance
- Use rate limiting to avoid DoS
- Scan during maintenance windows
- Document all findings
- Verify vulnerabilities manually
- Provide remediation guidance
- Re-scan after fixes

❌ DON'T:
- Scan without authorization
- Use aggressive settings on production
- Rely solely on automated tools
- Ignore false positives
- Share vulnerabilities publicly before fix
- Test exploits without permission
- Forget to clean up test data
```

---

## Legal Considerations

```text
⚠️ WARNING:
Unauthorized scanning may be illegal under:
- Computer Fraud and Abuse Act (CFAA) - USA
- Computer Misuse Act - UK
- Similar laws in other countries

Always:
1. Get written authorization
2. Define scope clearly
3. Follow responsible disclosure
4. Document permission
5. Use bug bounty programs when available
```

---

## Further Reading

- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)
- [HackerOne Disclosure Guidelines](https://www.hackerone.com/disclosure-guidelines)
- [NIST NVD](https://nvd.nist.gov/)
- [CVE Details](https://www.cvedetails.com/)

